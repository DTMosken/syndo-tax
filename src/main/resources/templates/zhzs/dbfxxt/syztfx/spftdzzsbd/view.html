<!DOCTYPE HTML>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<meta charset="utf-8">
<head>
	<th:block th:include="include :: layui-header('商品房销售土地增值税税源比对')" />
	<style type="text/css">
		.layui-card-header{
			height: auto;
		}
	</style>
</head>
<body class="layui-body-table">
<div class="layui-card">
	<div class="layui-card-header">
		<form id="query-form" class="layui-form">
			<div class="layui-form-item layui-row">
				<div class="layui-inline layui-col-sm2 layui-col-md2">
					<label class="layui-form-label">税款所属期起： </label>
					<div class="layui-input-block">
						<input type="text" id="skssqq" name="skssqq" th:value="${skssqq}"
							   readonly="readonly" autocomplete="off"
							   data-type="month" data-format="yyyy-MM"
							   class="layui-input time-input">
					</div>
				</div>
				<div class="layui-inline layui-col-sm2 layui-col-md2">
					<label class="layui-form-label">税款所属期止： </label>
					<div class="layui-input-block">
						<input type="text" id="skssqz" name="skssqz" th:value="${skssqz}"
							   readonly="readonly" autocomplete="off"
							   data-type="month" data-format="yyyy-MM"
							   class="layui-input time-input">
					</div>
				</div>
				<div class="layui-inline layui-col-sm3 layui-col-md4">
					<label class="layui-form-label">纳税人名称：</label>
					<div class="layui-input-block">
						<input type="text" id="qymc" name="qymc" th:value="${param.nsrmc}" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline layui-col-sm2 layui-col-md2">
					<label class="layui-form-label">是否欠缴：</label>
					<div class="layui-input-block">
						<select id="sfqj" name="sfqj" th:with="type=${@dict.getType('dm_dbfxxt_syztfx_sfqj')}"  class="form-control input-sm">
							<option value=""></option>
							<option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item layui-row">
				<div class="layui-inline layui-col-sm2 layui-col-md2">
					<label class="layui-form-label">疑似差额大于：</label>
					<div class="layui-input-block">
						<input type="text" id="cedy" name="cedy" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline layui-col-sm2 layui-col-md2">
					<label class="layui-form-label">疑似差额小于：</label>
					<div class="layui-input-block">
						<input type="text" id="cexy" name="cexy" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline layui-col-sm2 layui-col-md2">
					<label class="layui-form-label">反馈状态:</label>
					<div class="layui-input-block">
						<select id="zt" name="zt" class="form-control input-sm">
							<option value=""></option>
							<option value="1">待反馈</option>
							<option value="2">已反馈</option>
							<option value="3">已完成</option>
						</select>
					</div>
				</div>
				<div class="layui-inline layui-col-sm2 layui-col-md2">
					<div class="layui-form-btn" style="text-align: right">
						<a class="layui-btn layui-btn-normal layui-btn-sm" onclick="$.table.search()">
							<i class="layui-icon">&#xe615;</i> 查询
						</a>
						<a class="layui-btn layui-btn-primary layui-btn-sm" onclick="$.table.reset()">
							<i class="layui-icon">&#xe669;</i> 重置
						</a>
					</div>
				</div>
			</div>

		</form>
	</div>
	<div class="layui-card-body">
		<table id="layui-table" lay-filter="layui-table"></table>
	</div>
</div>
<script type="text/html" id="ztTpl">
	{{# if(d.zt > '0'){ }}
	<a href="javascript:;" onclick="ckfk('{{d.fkid}}')" class="layui-table-link">{{ d.ztmc }}</a>
	{{# } else { }}
	{{ d.ztmc }}
	{{# } }}
</script>
    <th:block th:include="include :: layui-footer" />
    <script th:inline="javascript">
        var prefix = ctx + "zhzs/dbfxxt/syztfx/spftdzzsbd";

        $(function() {
            var options = {
                url: prefix + "/list",
				exportUrl: prefix + "/expExcel",
                title: "商品房土地增值税比对",
				height:"full-110",
		        showExport: true,
                cols: [[{
		            checkbox: true
		        },
				{
					field : 'objId', 
					hide:true
				},
				{
					field : 'qymc', 
					title : '纳税人名称',
					width : '180'
				},
				{
					field : 'skssqq', 
					title : '税款所属期起',
					width : '110'
				},
				{
					field : 'skssqz', 
					title : '税款所属期止',
					width : '110'
				},
				{
					field : 'xmmc', 
					title : '包含项目',
					width : '150',
					sortable: true
				},
				{
					field : 'mj', 
					title : '销售总面积（平方米）',
					width : '150',
					sortable: true
				},
				{
					field : 'zje', 
					title : '销售合同额(元)',
					width : '120',
					sortable: true
				},
				{
					field : 'yjje', 
					title : '估算应纳税额(元)',
					width : '130',
					sortable: true
				},
				{
					field : 'sjje', 
					title : '实缴税额(元)',
					width : '120',
					sortable: true
				},
				{
					field : 'yjce', 
					title : '疑似差额(元)',
					width : '120',
					sortable: true
				},
				{
					title : '查看详情',
					width : '120',
					align: 'center',
					templet: function(row) {
		                var actions = [];
		                actions.push('<a class="btn btn-info btn-xs" href="#" onclick="ckxq(\'' + row.qymc+'\',\'' + row.skssqq+'\',\'' + row.skssqz +'\',\'' + row.sfqj +'\',\''+ row.cedy +'\',\''+ row.cexy +'\',\''+ row.zzcedy +'\',\''+ row.zzcexy +'\')"><i class="fa fa-edit"></i>月度详情</a> ');
		                return actions.join('');
		            }
				},{ field: "ztmc", title: "反馈状态", width: 100, align: "center", templet: '#ztTpl' },] ]
            };
            $.table.init(options);
            
        });
        
        /* 查看详情 */
        function ckxq(qymc,skssqq,skssqz,cedy,cexy,zzcedy,zzcexy) {   
        	var url = prefix + '/twoList?qymc=' + encodeURI(qymc)+'&skssqq='+skssqq+'&skssqz='+skssqz+'&sfqj='+encodeURI(sfqj)+'&cedy='+$("#cedy").val()+'&cexy='+$("#cexy").val()+'&zzcedy='+$("#zzcedy").val()+'&zzcexy='+$("#zzcexy").val();
        	$.modal.openFull("查看详情", url, false);
		}  
        
        layui.use('laydate', function(){
          var laydate = layui.laydate;
      	  laydate.render({elem: '#skssqq', format:'yyyy-MM',type:'month'});
      	  laydate.render({elem: '#skssqz', format:'yyyy-MM',type:'month'});
      });
    </script>
</body>
</html>